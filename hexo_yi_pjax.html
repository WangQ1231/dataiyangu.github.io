<!-- build time:Sat Apr 06 2019 08:14:32 GMT+0800 (China Standard Time) --><!DOCTYPE html><script src="/js/src/pjax/jquery_min_js.js"></script><script src="/js/src/pjax/jquery_pjax_min_js.js"></script><script src="/js/src/pjax/pjaxMain.js"></script><html class="theme-next muse use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4"><link rel="mask-icon" href="/images/favicon.ico?v=5.1.4" color="#222"><link rel="manifest" href="/images/favicon.ico"><meta name="msapplication-config" content="/images/favicon.ico"><meta name="keywords" content="hexo,"><link rel="alternate" href="/atom.xml" title="Leesin's Blog" type="application/atom+xml"><meta name="description" content="一篇关于在next主题中加入pjax的文章，让你的文章如钻石般夺目。"><meta name="keywords" content="hexo"><meta property="og:type" content="article"><meta property="og:title" content="hexo next主题深度优化(一)，加入pjax功能"><meta property="og:url" content="http://mmmmmm.me/hexo_yi_pjax.html"><meta property="og:site_name" content="Leesin&#39;s Blog"><meta property="og:description" content="一篇关于在next主题中加入pjax的文章，让你的文章如钻石般夺目。"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2019-04-05T23:37:48.162Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="hexo next主题深度优化(一)，加入pjax功能"><meta name="twitter:description" content="一篇关于在next主题中加入pjax的文章，让你的文章如钻石般夺目。"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",version:"5.1.4",sidebar:{position:"left",display:"hide",offset:12,b2t:!1,scrollpercent:!1,onmobile:!0},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"P88H67GUII",apiKey:"5489ac7ce78f59f4a8cb5445035f54d8",indexName:"dataiyangu",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://mmmmmm.me/hexo_yi_pjax.html"><title>hexo next主题深度优化(一)，加入pjax功能 | Leesin's Blog</title></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><link rel="stylesheet" href="/dist/APlayer.min.css"><div class="hover_sidebar"></div><header id="header_left" class="header_left" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header_left_inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu_left" class="menu_left"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-top"><a href="/top/" rel="section"><i class="menu-item-icon fa fa-fw fa-signal"></i><br>热度</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-message"><a href="/message/" rel="section"><i class="menu-item-icon fa fa-fw fa-heart"></i><br>留言</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="algolia-popup popup search-popup"><div class="algolia-search"><div class="algolia-search-input-icon"><i class="fa fa-search"></i></div><div class="algolia-search-input" id="algolia-search-input"></div></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div id="algolia-pagination" class="algolia-pagination"></div></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div></div></nav></div><div class="header_sidebar">黑匣子</div></header><div class="eye"><div class="eye1"><ul><li style="background-color:#C7EDCC">豆沙绿</li><li style="background-color:#FAF9DE">杏仁黄</li><li style="background-color:#FFF">银河白</li><li style="background-color:#323232">极光黑</li><li style="background-color:#FFF2E2">秋叶褐</li><li style="background-color:#FDE6E0">胭脂红</li><li style="background-color:#E3EDCD">青草绿</li><li style="background-color:#DCE2F1">海天蓝</li><li style="background-color:#E9EBFE">葛巾紫</li><li style="background-color:#EAEAEF">极光灰</li><li style="background-color:#cce8cf">qq管家</li></ul></div><div class="eye2">满天星</div></div><div id="aplayer"></div><script type="text/javascript" src="/dist/APlayer.min.js"></script><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><a href="https://github.com/dataiyangu?tab=repositories"><img style="position:absolute;top:0;left:0;border:0" alt="Fork me on GitHub" data-original="/images/github_fork.png"></a><div class="bg_content"><canvas id="canvas"></canvas></div><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Leesin's Blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">To be a better me</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-top"><a href="/top/" rel="section"><i class="menu-item-icon fa fa-fw fa-signal"></i><br>热度</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-message"><a href="/message/" rel="section"><i class="menu-item-icon fa fa-fw fa-heart"></i><br>留言</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="algolia-popup popup search-popup"><div class="algolia-search"><div class="algolia-search-input-icon"><i class="fa fa-search"></i></div><div class="algolia-search-input" id="algolia-search-input"></div></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div id="algolia-pagination" class="algolia-pagination"></div></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div></div></nav></div></header><div id="pjax-container"><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article data-scroll-reveal="enter bottom move 80px over 1s after 0.0s" class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://mmmmmm.me/hexo_yi_pjax.html"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Leesin.Dong"><meta itemprop="description" content=""><meta itemprop="image" content="/images/header.jpg"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Leesin's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">hexo next主题深度优化(一)，加入pjax功能</h1><div class="post-meta"><i class="fa fa-thumb-tack"></i> <font color="7D26CD">置顶</font> <span class="post-meta-divider">|</span> <span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-18T19:20:00+08:00">2018-12-18 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span> </a></span></span><span id="/hexo_yi_pjax.html" class="leancloud_visitors" data-flag-title="hexo next主题深度优化(一)，加入pjax功能"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数&#58;</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-divider">|</span> <span class="page-pv"><i class="fa fa-file-o"></i>Read the number <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>times</span><div class="post-wordcount"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">4.8k字 </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">21分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><h1><a href="#" class="headerlink"></a><img alt="upload successful" data-original="../images/my_blog_10.png"></h1><blockquote><ul><li>一篇关于在next主题中加入pjax的文章，让你的文章如钻石般夺目。</li></ul></blockquote><a id="more"></a><p>特别声明：<br><strong>看不懂没关系，往下读，因为我写的逻辑可能不是很清晰~<br>本人源码在github上实在不懂的 git clone自己扣一扣，github在博客中有连接<br>本人博客mmmmmm.me</strong></p><h1 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h1><p>我有强迫症，遇到好的东西就想给自己整上去，在这里想忠诚的奉劝大家一句，不要再搭建自己的博客了，这是一个无底洞，就跟打游戏一样，当你到达六十级之后，你发现版本更新了，顶级变成了八十级，而且，目前看来你自己只有三级，只是自己感觉自己是六十级，就像我，这个东西我足足花了一周多，当然也有我经常加班的原因吧，好了不吐槽了~~</p><h1 id="进入正题"><a href="#进入正题" class="headerlink" title="进入正题"></a>进入正题</h1><h2 id="pjax初体验–instantclick"><a href="#pjax初体验–instantclick" class="headerlink" title="pjax初体验–instantclick"></a>pjax初体验–instantclick</h2><p>首先本人加了一个不蒜子的群，看到有人说instantclick能够实现自己的博客实现不中断的播放（大家都知道博客一刷新，一换页，播放的歌曲插件肯定也会刷新，歌也就断了），看到这里是不是有感觉了~~，这个时候我就开始拼命的往里面加，大概花了两天放弃了，可是无奈中文文档也比较少，而且，bug巨多，最大的原因也是bug巨多，适配起来十分麻烦，比如多说评论系统等等。但是速度确实蛮快的，因为可以1鼠标放到标签上实现预加载2鼠标点下去的瞬间实现预加载，而且可以自己设定预加载的时间。（好像是这么回事，时间太久远了）<br>下面贴出我找到的几个教程，对于bug多这点不介意，喜欢钻研的同学可以看看：<br><a href="https://www.ihewro.com/archives/515/" target="_blank" rel="noopener">https://www.ihewro.com/archives/515/</a><br><a href="https://qqdie.com/archives/instantclick.html" target="_blank" rel="noopener">https://qqdie.com/archives/instantclick.html</a><br><a href="https://www.jianshu.com/p/c306360e4270" target="_blank" rel="noopener">https://www.jianshu.com/p/c306360e4270</a><br><a href="https://www.songhaifeng.com/razt/32.html" target="_blank" rel="noopener">https://www.songhaifeng.com/razt/32.html</a><br>好了就先这么多，google上也有好多，赶紧让我们进入正题吧~</p><h2 id="真正的pjax"><a href="#真正的pjax" class="headerlink" title="真正的pjax"></a>真正的pjax</h2><p>官方介绍：pushState + ajax = pjax 带来最直观的效果是整个网站变成单页应用。这样的效果将会极大的提升用户体验，并且可以减少https的请求的次数和内容。使用github上面的一个开源项目defunkt/jquery-pjax 可以很轻松的帮助我们实现pjax。</p><p>这样可以实现，刷新的时候只加载局部的html和css js 大大加快速度。<br>真诚提醒：如果对前端一点点基础都没有的话，要不就放弃吧。</p><h3 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h3><p>找到theme-&gt;next-&gt;layout-&gt;_layout.swig文件<br>在开头加入以下代码：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/src/pjax/pjaxBase.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>解释一下：前两行是引入jq文件和pjax的js文件，jq文件必须在pjax文件前面引入，第三行是引入我自己的文件，这个文件是我自己diy的目录如图。在第二行下面<script></script>中间加入内容是一样的效果。</p></blockquote><h3 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h3><p>还是在这个文件中在底部加入</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;# 在这里依次加载<span class="name">pjax</span>需要的js文件 #&#125;</span><span class="xml">//swig文件中的注释是这样子的</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>   <span class="attr">src</span>=<span class="string">"/js/src/pjax/category_js.js"</span> &gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>   <span class="attr">src</span>=<span class="string">"/js/src/pjax/opacity_js.js"</span> &gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>   <span class="attr">src</span>=<span class="string">"/js/src/pjax/motion_js.js"</span> &gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>   <span class="attr">src</span>=<span class="string">"/js/src/pjax/velocity.ui_js.js"</span> &gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>   <span class="attr">src</span>=<span class="string">"/js/src/pjax/velocity_js.js"</span> &gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>   <span class="attr">src</span>=<span class="string">"/js/src/pjax/bootstrap_js.js"</span> &gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>   <span class="attr">src</span>=<span class="string">"/js/src/pjax/scrollspy_js.js"</span> &gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>   <span class="attr">src</span>=<span class="string">"/js/src/pjax/utils_js.js"</span> &gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>   <span class="attr">src</span>=<span class="string">"/js/src/pjax/post-details_js.js"</span> &gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>注意这里的文件是有顺序的，具体的我会在下文详细讲述。</p><h3 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h3><p>第二步中的这些文件都是我自己加入的，原因是因为（划重点了！！！）<br><strong>在pjax中是局部刷新的也就是局部加载的，而以上的文件，next主题中本身是没有的，原来的文件名称没有我的_js后缀，在目录next-&gt;source-&gt;js-&gt;src下面，<br>源文件大部分都是$(document).ready()的，这个函数，大家可以上网好好查查，是加载完整个dom结构后进行加载的，当然了和js中的Window.onload是不一样的，后者是在图片等全部加载完之后才会加载js，好了不闲扯了，注意将这些文件复制到我上面的目录下并且重命名例如：/js/src/pjax/bootstrap_js.js然后将所有的文件都把$(document).ready()去掉，然后用function xxx包住，这样就可以外部调用了，我会在下面讲到，很有用哦。</strong></p><blockquote><p>为什么这么麻烦，因为next的js是相互调用的，本人比较懒，实在没有时间阅读全部的源码。</p></blockquote><p>目录：</p><h3 id="第四步"><a href="#第四步" class="headerlink" title="第四步"></a>第四步</h3><p><img alt="upload successful" data-original="../images/my_blog_11.png"></p><p>如上面的目录，这些有的是我复制的系统核心的，因为在p我单独还建了一个/js/src/pjax/pjaxBase.js，你可能就懂了第一步了。这个js是pjax的核心，下面贴出源码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define(['jquery','jquery_pjax_min_js'],function () &#123;</span></span><br><span class="line">$(<span class="built_in">document</span>).pjax(<span class="string">'a[target!=_blank]'</span>, <span class="string">'#pjax-container'</span>, &#123;</span><br><span class="line">  fragment: <span class="string">'#pjax-container'</span>,</span><br><span class="line">  timeout: <span class="number">5000</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//用户通过浏览器的前进后退按钮，需要加载的js</span></span><br><span class="line">$(<span class="built_in">window</span>).on(<span class="string">'popstate.pjax'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="built_in">document</span>).on(<span class="string">'pjax:complete'</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      $(<span class="string">'img'</span>).lazyload(&#123;</span><br><span class="line">        placeholder: <span class="string">'../images/loading.gif'</span>,</span><br><span class="line">        effect: <span class="string">'fadeIn'</span>,</span><br><span class="line">        threshold : <span class="number">100</span>,</span><br><span class="line">        failure_limit : <span class="number">20</span>,</span><br><span class="line">        skip_invisible : <span class="literal">false</span></span><br><span class="line">      &#125;);</span><br><span class="line">      pjax();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">$(<span class="built_in">document</span>).on(<span class="string">'pjax:start'</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  &#125;)</span><br><span class="line">$(<span class="built_in">document</span>).on(<span class="string">'pjax:complete'</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">require</span>.config(&#123;</span><br><span class="line">      paths: &#123;</span><br><span class="line">      <span class="comment">//下面注释的这几个js是之前的版本，因为给主题加入了require.js提升性能，所以将他们整合到了下面pjax_function_public文件中，效果是一样的。</span></span><br><span class="line">        <span class="comment">// "category_js": "/js/src/pjax/category_js",</span></span><br><span class="line">        <span class="comment">// "opacity_js":"/js/src/pjax/opacity_js",</span></span><br><span class="line">        <span class="comment">// "motion_js":"/js/src/pjax/motion_js",</span></span><br><span class="line">        <span class="comment">// "scrollspy_js":"/js/src/pjax/scrollspy_js",</span></span><br><span class="line">        <span class="comment">// "post-details_js":"/js/src/pjax/post-details_js",</span></span><br><span class="line">        <span class="comment">// "lean_analytics":"/js/src/pjax/lean_analytics",</span></span><br><span class="line">        <span class="comment">// "baidutuisong":"/js/src/pjax/baidutuisong",</span></span><br><span class="line">        <span class="comment">// "utils_js":"/js/src/pjax/utils_js",</span></span><br><span class="line">        <span class="comment">//这个是单独的</span></span><br><span class="line">        <span class="string">"jquery.share.min"</span>:<span class="string">"/js/src/pjax/share/jquery.share.min"</span>,</span><br><span class="line">        <span class="comment">// "share":"/js/src/pjax/share",</span></span><br><span class="line">        <span class="comment">//这个也是单独的</span></span><br><span class="line">        <span class="string">"css"</span>:<span class="string">"/js/src/pjax/css"</span>,</span><br><span class="line">        <span class="comment">//我将上面注释的内容整合到了这个js中，为了更好的提升性能，因为虽然一样的内容，多次读取文件，和读一个文件，效率还是有很大的差距的。</span></span><br><span class="line">        <span class="string">"pjax_function_public"</span>:<span class="string">"/js/src/pjax/pjax_function_public"</span></span><br><span class="line">      &#125;,</span><br><span class="line">      shim: &#123;</span><br><span class="line">        <span class="string">'share'</span>: &#123;</span><br><span class="line">          deps: [</span><br><span class="line">            <span class="string">'css!/js/src/pjax/share/share.min'</span>,<span class="string">'jquery.share.min'</span></span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">require</span>([<span class="string">'jquery.share.min'</span>,<span class="string">'share'</span>,<span class="string">'css'</span>,<span class="string">'pjax_function_public'</span></span><br><span class="line">    ], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="string">'img'</span>).lazyload(&#123;</span><br><span class="line">          placeholder: <span class="string">'../images/loading.gif'</span>,</span><br><span class="line">          effect: <span class="string">'fadeIn'</span>,</span><br><span class="line">          threshold : <span class="number">100</span>,</span><br><span class="line">          failure_limit : <span class="number">20</span>,</span><br><span class="line">          skip_invisible : <span class="literal">false</span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">      pjax();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pjax</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*因为下面的postdetails_js中的有个判断空指针的，如果加上就不能左移，如果去掉会报错，所以把这个放在首行来执行。*/</span></span><br><span class="line">  <span class="comment">/*现在已经解决,可以放在任意的位置*/</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">      之前一直是好的突然有次就不好了，后来解决了右边sidebar滚轮效果消失的效果之后，突然又好了。</span></span><br><span class="line"><span class="comment">      原因是因为，之前放在detail js的下面，而detail的下面undfind的判断时报错的，所以不会往下走。</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="comment">/*判断#lv-container是否为空，目前这是我找到最好的办法，因为不判断，进入首页或其他的页面会空指针异常。*/</span></span><br><span class="line">  <span class="keyword">if</span> ($(<span class="string">"#lv-container"</span>).length &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">    $(<span class="string">".comments"</span>).css(&#123;<span class="attr">opacity</span>: <span class="number">1</span>&#125;);</span><br><span class="line">    $.getScript(<span class="string">"https://cdn-city.livere.com/js/embed.dist.js"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//不蒜子js</span></span><br><span class="line">  $.getScript(<span class="string">"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//自己写的分享</span></span><br><span class="line">  pjaxshare();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分类的js</span></span><br><span class="line">  category_js();</span><br><span class="line"><span class="comment">// 局部刷新后文章内容不显示bug的js</span></span><br><span class="line">  opacity_js()</span><br><span class="line"><span class="comment">//点击有目录的文章sidebar不显示的bug解决</span></span><br><span class="line">  motion_js()</span><br><span class="line">  scrollspy_js()</span><br><span class="line">  <span class="comment">//utils_js()</span></span><br><span class="line">  postdetails_js()</span><br><span class="line"><span class="comment">//lean数量统计的js，原来的js是在themes/next/layout/_third-party/analytics/lean-analytics.swig文件中</span></span><br><span class="line">  lean_analytics();</span><br><span class="line">  <span class="comment">//百度推送js</span></span><br><span class="line">  baidutuisong();</span><br><span class="line"><span class="comment">//     //右边sidebar滚轮效果消失了。</span></span><br><span class="line">  initSidebarDimension()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解释一下：<br>$(document).pjax(‘a[target!=_blank]’ ‘#main’, {<br>fragment: ‘#main’,<br>timeout: 5000,<br>});<br>这个函数是pjax的核心，<br>‘a[target!=_blank]’是你将会点击的标签[target!=_blank]，是当你的标签是blank的时候就是需要点击出现一个新的窗口，比如友链之类的，这个时候就不进行局部加载了，没有类似a标签的可以省略。<br>‘#main’是你将会刷新的地方<br>fragment: ‘#main’,是把那个地方的代码刷新然后放到’#main’中<br>timeout，懂js得都懂就不解释了。</p><p>$(document).on(‘pjax:complete’,<br>function() {}<br>划重点了：这个函数是在局部加载完之后自己需要DIY的js，因为pjax是局部加载我已经强调了很多遍了，这个时候有的js会失效比如说评论功能。<br>这个时候引入我们之前定义好的函数。完成！</p><p>贴几个对我很有帮助的博文和hexo next的博客和一个github，实在不懂得可以扒一扒别人的github源码，有很大的帮助。<br><a href="https://www.ihewro.com/archives/354/comment-page-3#comments" target="_blank" rel="noopener">https://www.ihewro.com/archives/354/comment-page-3#comments</a><br><a href="https://www.jimoe.cn/archives/typecho-add-pjax.html" target="_blank" rel="noopener">https://www.jimoe.cn/archives/typecho-add-pjax.html</a><br><a href="http://yelog.org/2017/02/08/pjax/" target="_blank" rel="noopener">http://yelog.org/2017/02/08/pjax/</a><br><a href="https://www.jianshu.com/p/808a647dc324" target="_blank" rel="noopener">https://www.jianshu.com/p/808a647dc324</a><br><a href="https://blog.dyboy.cn/" target="_blank" rel="noopener">https://blog.dyboy.cn/</a><br><a href="https://blog.flysay.com/" target="_blank" rel="noopener">https://blog.flysay.com/</a><br><a href="https://github.com/DIYgod/hexo-theme-sagiri" target="_blank" rel="noopener">https://github.com/DIYgod/hexo-theme-sagiri</a><br><a href="http://www.qingpingshan.com/m/view.php?aid=355579" target="_blank" rel="noopener">http://www.qingpingshan.com/m/view.php?aid=355579</a><br><a href="https://diygod.me/" target="_blank" rel="noopener">https://diygod.me/</a><br>中间有个小技巧:chrom的审查元素里面的内容是可以移动和删除的，更利于我们的检查。</p><h1 id="专门基于hexo-next主题的pjax（将丢失的js效果重现）"><a href="#专门基于hexo-next主题的pjax（将丢失的js效果重现）" class="headerlink" title="专门基于hexo next主题的pjax（将丢失的js效果重现）"></a>专门基于hexo next主题的pjax（将丢失的js效果重现）</h1><h2 id="将下面讲到的提取出来"><a href="#将下面讲到的提取出来" class="headerlink" title="将下面讲到的提取出来"></a>将下面讲到的提取出来</h2><p><strong>因为很多事被包装在$(documnent).ready(function(){})里面的，所以pjax不能加载的原因就在这里。自己提取出来，封装成函数自己调用即可</strong><br><strong>下面的需要前端基础，会通过断点进行审查</strong></p><h2 id="点击右边的sidebar，sidebar不出现"><a href="#点击右边的sidebar，sidebar不出现" class="headerlink" title="点击右边的sidebar，sidebar不出现"></a>点击右边的sidebar，sidebar不出现</h2><p>经过阅读源码，点击事件在motion.js中，将相应的代码提取出来<br>motion.js<br></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">      <span class="keyword">this</span>.toggleEl.on(<span class="string">'click'</span>, <span class="keyword">this</span>.clickHandler.bind(<span class="keyword">this</span>));</span><br><span class="line">      <span class="keyword">this</span>.dimmerEl.on(<span class="string">'click'</span>, <span class="keyword">this</span>.clickHandler.bind(<span class="keyword">this</span>));</span><br><span class="line">      <span class="keyword">this</span>.toggleEl.on(<span class="string">'mouseenter'</span>, <span class="keyword">this</span>.mouseEnterHandler.bind(<span class="keyword">this</span>));</span><br><span class="line">      <span class="keyword">this</span>.toggleEl.on(<span class="string">'mouseleave'</span>, <span class="keyword">this</span>.mouseLeaveHandler.bind(<span class="keyword">this</span>));</span><br><span class="line">      <span class="keyword">this</span>.sidebarEl.on(<span class="string">'touchstart'</span>, <span class="keyword">this</span>.touchstartHandler.bind(<span class="keyword">this</span>));</span><br><span class="line">      <span class="keyword">this</span>.sidebarEl.on(<span class="string">'touchend'</span>, <span class="keyword">this</span>.touchendHandler.bind(<span class="keyword">this</span>));</span><br><span class="line">      <span class="keyword">this</span>.sidebarEl.on(<span class="string">'touchmove'</span>, function(e)&#123;e.preventDefault();&#125;);</span><br><span class="line">`</span><br></pre></td></tr></table></figure><p></p><p>post_detail.js<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TOC item animation navigate &amp; prevent #item selector in adress bar.</span></span><br><span class="line">  $(<span class="string">'.post-toc a'</span>).on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    <span class="keyword">var</span> targetSelector = NexT.utils.escapeSelector(<span class="keyword">this</span>.getAttribute(<span class="string">'href'</span>));</span><br><span class="line">    <span class="keyword">var</span> offset = $(targetSelector).offset().top;</span><br><span class="line"></span><br><span class="line">    hasVelocity ?</span><br><span class="line">      html.velocity(<span class="string">'stop'</span>).velocity(<span class="string">'scroll'</span>, &#123;</span><br><span class="line">        offset: offset  + <span class="string">'px'</span>,</span><br><span class="line">        mobileHA: <span class="literal">false</span></span><br><span class="line">      &#125;) :</span><br><span class="line">      $(<span class="string">'html, body'</span>).stop().animate(&#123;</span><br><span class="line">        scrollTop: offset</span><br><span class="line">      &#125;, <span class="number">500</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p></p><p>这是线索，像java一样点到自己需要的地方，展开逻辑。</p><h3 id="sidebar自动隐藏，自动显示，点击出现，点击隐藏，回到首页，回到中间等操作"><a href="#sidebar自动隐藏，自动显示，点击出现，点击隐藏，回到首页，回到中间等操作" class="headerlink" title="sidebar自动隐藏，自动显示，点击出现，点击隐藏，回到首页，回到中间等操作"></a>sidebar自动隐藏，自动显示，点击出现，点击隐藏，回到首页，回到中间等操作</h3><p>里面如果遇到不认识的函数，可能是hexo自己封装的比如toc，<br>hexo自己的辅助函数：<a href="https://hexo.io/zh-cn/docs/helpers.html" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/helpers.html</a><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">下面这段代码是关于右边的sidebar的js的核心包括：</span></span><br><span class="line"><span class="comment">  自动隐藏，自动显示，点击出现，点击隐藏，回到首页，回到中间等操作*/</span></span><br><span class="line">  <span class="comment">// Expand sidebar on post detail page by default, when post has a toc.</span></span><br><span class="line">  var $tocContent = $(<span class="string">'.post-toc-content'</span>);</span><br><span class="line">  var isSidebarCouldDisplay = CONFIG.sidebar.display === <span class="string">'post'</span> ||</span><br><span class="line">      CONFIG.sidebar.display === <span class="string">'always'</span>;</span><br><span class="line">  var hasTOC = $tocContent.length &gt; <span class="number">0</span> &amp;&amp; $tocContent.html().trim().length &gt; <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (isSidebarCouldDisplay &amp;&amp; hasTOC) &#123;</span><br><span class="line"></span><br><span class="line">      NexT.utils.displaySidebar();</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">/*判断this.sidebarEl是否为null，因为从首页进入留言板的时候并没有this.sidebarEl这个属性，回报类似于空指针的异常。</span></span><br><span class="line"><span class="comment"> 下面这个空指针的判断暂时注释掉因为，如果打开的，返回到首页的时候并没有this.sidebarEl，</span></span><br><span class="line"><span class="comment">下面的代码不会进行，下面的，文章在左面没回去的bug就无法得到解决。*/</span></span><br><span class="line"><span class="comment">/*已经将空指针异常的判断打开，因为下面的源码是this.sidebar，这里的this可能并不是element，所以会导致未定义，其实在element中是定义了的</span></span><br><span class="line"><span class="comment">* 在这里将this去掉就解决了*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 下面这段源码在motion.js中的hideSidebar方法。*/</span></span><br><span class="line">    var sidebarEl=$(<span class="string">'.sidebar'</span>)</span><br><span class="line">    <span class="keyword">if</span> (typeof(sidebarEl)!=  <span class="string">"undefined"</span>) &#123;</span><br><span class="line">      NexT.utils.isDesktop() &amp;&amp; $(<span class="string">'body'</span>).velocity(<span class="string">'stop'</span>).velocity(&#123;paddingRight: <span class="number">0</span>&#125;);</span><br><span class="line">      sidebarEl.find(<span class="string">'.motion-element'</span>).velocity(<span class="string">'stop'</span>).css(<span class="string">'display'</span>, <span class="string">'none'</span>);</span><br><span class="line">      sidebarEl.velocity(<span class="string">'stop'</span>).velocity(&#123;width: <span class="number">0</span>&#125;, &#123;display: <span class="string">'none'</span>&#125;);</span><br><span class="line">      <span class="comment">/*sidebarToggleLines是在motion js里面的，在这里回报错，在下面进行了引用*/</span></span><br><span class="line">      sidebarToggleLines.init();</span><br><span class="line">      sidebarEl.removeClass(<span class="string">'sidebar-active'</span>);</span><br><span class="line">      sidebarEl.trigger(<span class="string">'sidebar.isHiding'</span>);</span><br><span class="line">      <span class="comment">// Prevent adding TOC to Overview if Overview was selected when close &amp; open sidebar.</span></span><br><span class="line">      <span class="comment">/*下面的else的js是我自己加的因为，点击有目录的文章后右侧sidebar会自动出来，文章会自动往左面走，因为margin是0 auto的。这个时候点击主页，</span></span><br><span class="line"><span class="comment">      文章还是在左面的没有回去，为了解决这个bug*/</span></span><br><span class="line">      <span class="keyword">if</span> (!!$(<span class="string">'.post-toc-wrap'</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($(<span class="string">'.site-overview-wrap'</span>).css(<span class="string">'display'</span>) === <span class="string">'block'</span>) &#123;</span><br><span class="line">          $(<span class="string">'.post-toc-wrap'</span>).removeClass(<span class="string">'motion-element'</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          $(<span class="string">'.post-toc-wrap'</span>).addClass(<span class="string">'motion-element'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">var sidebarToggleLines = &#123;</span><br><span class="line">  lines: [],</span><br><span class="line">  push: function (line) &#123;</span><br><span class="line">    <span class="keyword">this</span>.lines.push(line);</span><br><span class="line">  &#125;,</span><br><span class="line">  init: function () &#123;</span><br><span class="line">    <span class="keyword">this</span>.lines.forEach(function (line) &#123;</span><br><span class="line">      line.init();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  arrow: function () &#123;</span><br><span class="line">    <span class="keyword">this</span>.lines.forEach(function (line) &#123;</span><br><span class="line">      line.arrow();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  close: function () &#123;</span><br><span class="line">    <span class="keyword">this</span>.lines.forEach(function (line) &#123;</span><br><span class="line">      line.close();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">`</span><br></pre></td></tr></table></figure><p></p><h3 id="添加bootstrp出现闪屏的现象"><a href="#添加bootstrp出现闪屏的现象" class="headerlink" title="添加bootstrp出现闪屏的现象"></a>添加bootstrp出现闪屏的现象</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">//</span> <span class="string">.add</span><span class="params">(NexT.motion.middleWares.menu)</span>已经注释掉了</span><br></pre></td></tr></table></figure><p>貌似bootstrp不加也行,没有发现太需要重写的函数</p><h3 id="右边的sidebar鼠标滚动目录滑动事件没了"><a href="#右边的sidebar鼠标滚动目录滑动事件没了" class="headerlink" title="右边的sidebar鼠标滚动目录滑动事件没了"></a>右边的sidebar鼠标滚动目录滑动事件没了</h3><p>核心代码是utils.js中的initSidebarDimension（）函数<br>直接调用即可。<br>**强烈建议用有道词典看看那些个函数的注释，这个注释就写的很清楚，一开始我找了好久没有跟到相关的代码，最后，偶尔看到了，还好有点英语基础。<br>utils.js<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * Init Sidebar &amp; TOC inner dimensions on all pages and for all schemes.</span></span><br><span class="line"><span class="comment">  * Need for Sidebar/TOC inner scrolling if content taller then viewport.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">initSidebarDimension</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">var</span> updateSidebarHeightTimer;</span><br><span class="line">   $(<span class="built_in">window</span>).on(<span class="string">'resize'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     updateSidebarHeightTimer &amp;&amp; clearTimeout(updateSidebarHeightTimer);</span><br><span class="line">     updateSidebarHeightTimer = setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> sidebarWrapperHeight = <span class="built_in">document</span>.body.clientHeight - NexT.utils.getSidebarSchemePadding();</span><br><span class="line">      updateSidebarHeight(sidebarWrapperHeight);</span><br><span class="line">     &#125;, <span class="number">0</span>);</span><br><span class="line">   &#125;);</span><br></pre></td></tr></table></figure><p></p><h3 id="局部刷新文章不显示了，文章那里是空白的。"><a href="#局部刷新文章不显示了，文章那里是空白的。" class="headerlink" title="局部刷新文章不显示了，文章那里是空白的。"></a>局部刷新文章不显示了，文章那里是空白的。</h3><p>经过审查，是opacity变成了0，我自定义了一个回调函数。<br>opacity.js<br></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> opacity_js() &#123;</span><br><span class="line">  /<span class="regexp">/ $(".post-block").css(&#123;visibility: 'visible',opacity:1&#125;);</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ $(".post-header").css(&#123;visibility: 'visible',opacity:1&#125;);</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ $(".post-body").css(&#123;visibility: 'visible',opacity:1&#125;);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  $(".post-block").css(&#123;opacity:1&#125;);</span></span><br><span class="line"><span class="regexp">  $(".post-header").css(&#123;opacity:1&#125;);</span></span><br><span class="line"><span class="regexp">  $(".post-body").css(&#123;opacity:1&#125;);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p></p><h3 id="评论没了"><a href="#评论没了" class="headerlink" title="评论没了"></a>评论没了</h3><p>我用的是来必力，其他的评论系统都是一样的操作，去评论系统的官网，或者阅读源码，跟到调用的api重新调用即可。<br><strong>注：下面紧跟着这个是之前错误的仅供记录，下面提供了正确的做法</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*判断#lv-container、comments是否为空，目前这是我找到最好的办法，因为不判断，进入首页或其他的页面会空指针异常。*/</span></span><br><span class="line">  <span class="keyword">if</span> ($(<span class="string">"#lv-container"</span>).length &gt; <span class="number">0</span> &amp;&amp;$(<span class="string">'.comments'</span>).length&gt;<span class="number">0</span>) &#123;</span><br><span class="line">    $(<span class="string">".comments"</span>).css(&#123;<span class="attr">opacity</span>: <span class="number">1</span>&#125;);</span><br><span class="line">    $.getScript(<span class="string">"https://cdn-city.livere.com/js/embed.dist.js"</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>注：上面的版本是之前错误的，经过阅读源码</strong><br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ($(<span class="string">"#lv-container"</span>).length &gt; <span class="number">0</span> &amp;&amp;$(<span class="string">'.comments'</span>).length&gt;<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p></p><p>这句话是没用的,因为每个页面里面易经理加入了这个,并且js是没有重写完整的<br><strong>正确做法：</strong><br></p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">function</span>(<span class="name">d</span>, s) &#123;</span><br><span class="line">    var j, e = d.getElementsByTagName(<span class="name">s</span>)[<span class="name">0</span>]<span class="comment">;</span></span><br><span class="line">    if (<span class="name">typeof</span> LivereTower === <span class="symbol">'function</span>') &#123; return<span class="comment">; &#125;</span></span><br><span class="line">    j = d.createElement(<span class="name">s</span>)<span class="comment">;</span></span><br><span class="line">    j.src = <span class="symbol">'https://cdn-city.livere.com/js/embed.dist.js</span>'<span class="comment">;</span></span><br><span class="line">    j.async = true<span class="comment">;</span></span><br><span class="line">    e.parentNode.insertBefore(<span class="name">j</span>, e)<span class="comment">;</span></span><br><span class="line">  &#125;)(<span class="name">document</span>, <span class="symbol">'script</span>')<span class="comment">;</span></span><br></pre></td></tr></table></figure><p></p><p>403的错误是localhost的原因，通过域名访问就没事了<br>不报错401就没问题<br>更新，虽然现实没问题，可是每次到首页总是会报错，id notfound，才疏学浅久久不能解决，决定换成gittalk评论。<br>参看我的另一篇文章。</p><h3 id="局部会闪一下"><a href="#局部会闪一下" class="headerlink" title="局部会闪一下"></a>局部会闪一下</h3><p>boostrap.js bootstrap是必须注释掉的</p><h3 id="阅读数没了"><a href="#阅读数没了" class="headerlink" title="阅读数没了"></a>阅读数没了</h3><p>自定义了一个js<br><strong>注意我第一行的注释</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lean_analytics</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*里面的参数原来是&#123;&#123;&#125;&#125;，可能会出现问题，所以在这里我直接将appid和key粘贴过来，具体问题是什么不详*/</span></span><br><span class="line">  AV.initialize(<span class="string">"6og9b7lpddMqazBCDe8z4HqL-gzGzoHsz"</span>, <span class="string">"faKN7dalSdXLmYYJTRq98B1f"</span>);</span><br><span class="line">  $.getScript(<span class="string">"https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"</span>);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">showTime</span>(<span class="params">Counter</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> query = <span class="keyword">new</span> AV.Query(Counter);</span><br><span class="line">    <span class="keyword">var</span> entries = [];</span><br><span class="line">    <span class="keyword">var</span> $visitors = $(<span class="string">".leancloud_visitors"</span>);</span><br><span class="line"></span><br><span class="line">    $visitors.each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      entries.push( $(<span class="keyword">this</span>).attr(<span class="string">"id"</span>).trim() );</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    query.containedIn(<span class="string">'url'</span>, entries);</span><br><span class="line">    query.find()</span><br><span class="line">      .done(<span class="function"><span class="keyword">function</span> (<span class="params">results</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> COUNT_CONTAINER_REF = <span class="string">'.leancloud-visitors-count'</span>;</span><br><span class="line">        <span class="keyword">if</span> (results.length === <span class="number">0</span>) &#123;</span><br><span class="line">          $visitors.find(COUNT_CONTAINER_REF).text(<span class="number">0</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; results.length; i++) &#123;</span><br><span class="line">          <span class="keyword">var</span> item = results[i];</span><br><span class="line">          <span class="keyword">var</span> url = item.get(<span class="string">'url'</span>);</span><br><span class="line">          <span class="keyword">var</span> time = item.get(<span class="string">'time'</span>);</span><br><span class="line">          <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(url);</span><br><span class="line">          $(element).find(COUNT_CONTAINER_REF).text(time);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; entries.length; i++) &#123;</span><br><span class="line">          <span class="keyword">var</span> url = entries[i];</span><br><span class="line">          <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(url);</span><br><span class="line">          <span class="keyword">var</span> countSpan = $(element).find(COUNT_CONTAINER_REF);</span><br><span class="line">          <span class="keyword">if</span>( countSpan.text() == <span class="string">''</span>) &#123;</span><br><span class="line">            countSpan.text(<span class="number">0</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      .fail(<span class="function"><span class="keyword">function</span> (<span class="params">object, error</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Error: "</span> + error.code + <span class="string">" "</span> + error.message);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">addCount</span>(<span class="params">Counter</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $visitors = $(<span class="string">".leancloud_visitors"</span>);</span><br><span class="line">    <span class="keyword">var</span> url = $visitors.attr(<span class="string">'id'</span>).trim();</span><br><span class="line">    <span class="keyword">var</span> title = $visitors.attr(<span class="string">'data-flag-title'</span>).trim();</span><br><span class="line">    <span class="keyword">var</span> query = <span class="keyword">new</span> AV.Query(Counter);</span><br><span class="line"></span><br><span class="line">    query.equalTo(<span class="string">"url"</span>, url);</span><br><span class="line">    query.find(&#123;</span><br><span class="line">      success: <span class="function"><span class="keyword">function</span>(<span class="params">results</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (results.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> counter = results[<span class="number">0</span>];</span><br><span class="line">          counter.fetchWhenSave(<span class="literal">true</span>);</span><br><span class="line">          counter.increment(<span class="string">"time"</span>);</span><br><span class="line">          counter.save(<span class="literal">null</span>, &#123;</span><br><span class="line">            success: <span class="function"><span class="keyword">function</span>(<span class="params">counter</span>) </span>&#123;</span><br><span class="line">              <span class="keyword">var</span> $element = $(<span class="built_in">document</span>.getElementById(url));</span><br><span class="line">              $element.find(<span class="string">'.leancloud-visitors-count'</span>).text(counter.get(<span class="string">'time'</span>));</span><br><span class="line">            &#125;,</span><br><span class="line">            error: <span class="function"><span class="keyword">function</span>(<span class="params">counter, error</span>) </span>&#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">'Failed to save Visitor num, with error message: '</span> + error.message);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">var</span> newcounter = <span class="keyword">new</span> Counter();</span><br><span class="line">          <span class="comment">/* Set ACL */</span></span><br><span class="line">          <span class="keyword">var</span> acl = <span class="keyword">new</span> AV.ACL();</span><br><span class="line">          acl.setPublicReadAccess(<span class="literal">true</span>);</span><br><span class="line">          acl.setPublicWriteAccess(<span class="literal">true</span>);</span><br><span class="line">          newcounter.setACL(acl);</span><br><span class="line">          <span class="comment">/* End Set ACL */</span></span><br><span class="line">          newcounter.set(<span class="string">"title"</span>, title);</span><br><span class="line">          newcounter.set(<span class="string">"url"</span>, url);</span><br><span class="line">          newcounter.set(<span class="string">"time"</span>, <span class="number">1</span>);</span><br><span class="line">          newcounter.save(<span class="literal">null</span>, &#123;</span><br><span class="line">            success: <span class="function"><span class="keyword">function</span>(<span class="params">newcounter</span>) </span>&#123;</span><br><span class="line">              <span class="keyword">var</span> $element = $(<span class="built_in">document</span>.getElementById(url));</span><br><span class="line">              $element.find(<span class="string">'.leancloud-visitors-count'</span>).text(newcounter.get(<span class="string">'time'</span>));</span><br><span class="line">            &#125;,</span><br><span class="line">            error: <span class="function"><span class="keyword">function</span>(<span class="params">newcounter, error</span>) </span>&#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">'Failed to create'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      error: <span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Error:'</span> + error.code + <span class="string">" "</span> + error.message);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> Counter = AV.Object.extend(<span class="string">"Counter"</span>);</span><br><span class="line">  <span class="keyword">if</span> ($(<span class="string">'.leancloud_visitors'</span>).length == <span class="number">1</span>) &#123;</span><br><span class="line">    addCount(Counter);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> ($(<span class="string">'.post-title-link'</span>).length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    showTime(Counter);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="百度统计-解决了footer自动推送"><a href="#百度统计-解决了footer自动推送" class="headerlink" title="百度统计(解决了footer自动推送)"></a>百度统计(解决了footer自动推送)</h3><p>baidutuisong.js<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">baidutuisong</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> bp = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">  <span class="keyword">var</span> curProtocol = <span class="built_in">window</span>.location.protocol.split(<span class="string">':'</span>)[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">if</span> (curProtocol === <span class="string">'https'</span>) &#123;</span><br><span class="line">    bp.src = <span class="string">'https://zz.bdstatic.com/linksubmit/push.js'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    bp.src = <span class="string">'http://push.zhanzhang.baidu.com/push.js'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"script"</span>)[<span class="number">0</span>];</span><br><span class="line">  s.parentNode.insertBefore(bp, s);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="不蒜子阅读次数失效-解决"><a href="#不蒜子阅读次数失效-解决" class="headerlink" title="不蒜子阅读次数失效(解决)"></a>不蒜子阅读次数失效(解决)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">.getScript(<span class="string">"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"</span>);</span></span><br></pre></td></tr></table></figure><h3 id="分类动态（css样式，js不行）"><a href="#分类动态（css样式，js不行）" class="headerlink" title="分类动态（css样式，js不行）"></a>分类动态（css样式，js不行）</h3><p>category.js<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">category_js</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//在a标签前面加个&gt;</span></span><br><span class="line">  <span class="keyword">if</span> ($(<span class="string">".jiantou"</span>).length==<span class="number">0</span>) &#123;</span><br><span class="line">    $(<span class="string">"&lt;div class='jiantou' style='float: left'&gt; &amp;nbsp&gt;&amp;nbsp &lt;/div&gt;"</span>).prependTo(<span class="string">".category-list-item"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//首相将子元素ul隐藏</span></span><br><span class="line">  $(<span class="string">".category-list-child"</span>).css(<span class="string">"display"</span>,<span class="string">"none"</span>);</span><br><span class="line">  <span class="comment">//改变a标签的样式，"display":"inline-block"同时拥有块元素和行元素的两种特性。</span></span><br><span class="line">  <span class="comment">//放到了css中</span></span><br><span class="line">  <span class="comment">// $(".category-list-link").css(&#123;"width":"1000px","display":"inline-block"&#125;);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//加入过滤器功能，因为if貌似不支持this功能，a标签如果有同级元素ul的话会使跳转功能失效，没有同级元素ul的话继续跳转</span></span><br><span class="line">  $(<span class="string">".category-list-link"</span>).filter(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $(<span class="keyword">this</span>).siblings(<span class="string">".category-list-child"</span>).length&gt;<span class="number">0</span></span><br><span class="line">  &#125;).attr(<span class="string">"href"</span>,<span class="string">"javascript:void(0)"</span>).css(&#123;<span class="string">"font-weight"</span>:<span class="string">"bold"</span>&#125;);</span><br><span class="line">  <span class="comment">//点击出现隐藏功能，a标签如果有同级元素ul的话会使跳转功能失效，没有同级元素ul的话继续跳转，上面已经做了处理。</span></span><br><span class="line">  $(<span class="string">".category-list-link"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="keyword">this</span>).siblings(<span class="string">".category-list-child"</span>).slideToggle();</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  $(<span class="string">".posts-expand .post-body ul li "</span>).css(<span class="string">"list-style-type"</span>, <span class="string">"none"</span>);</span><br><span class="line">  <span class="comment">//去掉下划线</span></span><br><span class="line">  $(<span class="string">".category-list-link "</span>).css(<span class="string">"border-bottom"</span>, <span class="string">"none"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="分享失败"><a href="#分享失败" class="headerlink" title="分享失败"></a>分享失败</h3><p>原来用的addthis，不行，又换百度，还是不行，干脆自己整了一个<br>网上有share.js(有兴趣的自己学习一下)<br>share.js<br></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// define([<span class="string">'jquery.share.min'</span>],<span class="function"><span class="keyword">function</span> <span class="params">()</span></span> &#123;</span><br><span class="line">var $<span class="built_in">config</span> = &#123;</span><br><span class="line">  sites : [<span class="string">'weibo'</span>,<span class="string">'qq'</span>, <span class="string">'wechat'</span>,<span class="string">'tencent'</span>,<span class="string">'qzone'</span>,<span class="string">'douban'</span>, <span class="string">'facebook'</span>,  <span class="string">'google'</span>,<span class="string">'twitter'</span>],</span><br><span class="line">  disabled: [ <span class="string">'linkedin'</span>, <span class="string">'diandian'</span>],</span><br><span class="line">  wechatQrcodeTitle: <span class="string">"微信扫一扫"</span>,</span><br><span class="line">  wechatQrcodeHelper: <span class="string">'&lt;p&gt;微信扫一扫，右上角分享&lt;/p&gt;'</span>,</span><br><span class="line">  source: <span class="string">'Leesin Dong'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$(<span class="string">'.post-spread'</span>).share($<span class="built_in">config</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pjaxshare</span><span class="params">()</span></span> &#123;</span><br><span class="line">  $(<span class="string">'.post-spread'</span>).share($<span class="built_in">config</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="评分系统（已经舍弃，感觉无用）"><a href="#评分系统（已经舍弃，感觉无用）" class="headerlink" title="评分系统（已经舍弃，感觉无用）"></a>评分系统（已经舍弃，感觉无用）</h3><h3 id="懒加载函数"><a href="#懒加载函数" class="headerlink" title="懒加载函数"></a>懒加载函数</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'img'</span>).lazyload(&#123;</span><br><span class="line"><span class="symbol">    placeholder:</span> <span class="string">'../images/loading.gif'</span>,</span><br><span class="line"><span class="symbol">    effect:</span> <span class="string">'fadeIn'</span>,</span><br><span class="line">    <span class="string">threshold :</span> <span class="number">100</span>,</span><br><span class="line">    <span class="string">failure_limit :</span> <span class="number">20</span>,</span><br><span class="line">    <span class="string">skip_invisible :</span> <span class="literal">false</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h1 id="忘了最后最重要的一点一点，点击浏览器的返回前进按钮，特效还是失败了"><a href="#忘了最后最重要的一点一点，点击浏览器的返回前进按钮，特效还是失败了" class="headerlink" title="忘了最后最重要的一点一点，点击浏览器的返回前进按钮，特效还是失败了"></a>忘了最后最重要的一点一点，点击浏览器的返回前进按钮，特效还是失败了</h1><p>辛辛苦苦google了三天的结果。<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">window</span>).on(<span class="string">'popstate.pjax'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  pjax();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p></p><p>暂时先这么多吧~<br>喜欢的点个星星，加个关注。</p></div><div><div><div style="text-align:center;color:#555;font-size:14px">-------------The End-------------</div></div></div><div><div class="my_post_copyright"><p><span>本文标题:</span><a href="/hexo_yi_pjax.html">hexo next主题深度优化(一)，加入pjax功能</a></p><p><span>文章作者:</span><a href="/" title="访问 Leesin.Dong 的个人博客">Leesin.Dong</a></p><p><span>发布时间:</span>2018年12月18日 - 19:12</p><p><span>最后更新:</span>2019年04月06日 - 07:04</p><p><span>原始链接:</span><a href="/hexo_yi_pjax.html" title="hexo next主题深度优化(一)，加入pjax功能">http://mmmmmm.me/hexo_yi_pjax.html</a></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>客官客官，不可以，你要对我负责～～～</div><button id="rewardButton" disable="enable"><script>window.onload=function(){var n=document.getElementById("QR"),e=document.getElementById("rewardButton");e.onclick=function(){"none"===n.style.display?n.style.display="block":n.style.display="none"}}</script><span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" alt="Leesin.Dong 微信支付" data-original="/images/wechatpay.jpg"><p>微信支付</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" alt="Leesin.Dong 支付宝" data-original="/images/alipay.jpg"><p>支付宝</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/hexo/" rel="tag"><i class="fa fa-tag"></i> hexo</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/To_myself.html" rel="next" title="肖申克的救赎"><i class="fa fa-chevron-left"></i> 肖申克的救赎</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/hexo_er_lazy.html" rel="prev" title="hexo next主题深度优化(二)，懒加载">hexo next主题深度优化(二)，懒加载 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div id="gitalk-container"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Leesin.Dong" data-original="/images/header.jpg"><p class="site-author-name" itemprop="name">Leesin.Dong</p><p class="site-description motion-element" itemprop="description">To be a better me</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">58</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">14</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">11</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/dataiyangu" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://blog.csdn.net/dataiyangu" target="_blank" title="CSDN"><i class="fa fa-fw fa-copyright"></i>CSDN</a> </span><span class="links-of-author-item"><a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=32248827@qq.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-E-Mail"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://mobile.twitter.com/dataiyangu" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i>Twitter</a> </span><span class="links-of-author-item"><a href="https://www.facebook.com/leesin.dong.923" target="_blank" title="FB Page"><i class="fa fa-fw fa-facebook"></i>FB Page</a> </span><span class="links-of-author-item"><a href="http://wpa.qq.com/msgrd?v=3&uin=32248827&site=hupaiyule&menu=yes" target="_blank" title="QQ"><i class="fa fa-fw fa-qq"></i>QQ</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> link</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://blog.csdn.net/dataiyangu" title="我的CSDN" target="_blank">我的CSDN</a></li><li class="links-of-blogroll-item"><a href="https://yelog.org" title="叶落阁" target="_blank">叶落阁</a></li><li class="links-of-blogroll-item"><a href="http://www.bianxiaofeng.com" title="边小丰" target="_blank">边小丰</a></li><li class="links-of-blogroll-item"><a href="https://qqdie.com" title="QQ爹" target="_blank">QQ爹</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">1.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#背景："><span class="nav-number">2.</span> <span class="nav-text">背景：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#进入正题"><span class="nav-number">3.</span> <span class="nav-text">进入正题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#pjax初体验–instantclick"><span class="nav-number">3.1.</span> <span class="nav-text">pjax初体验–instantclick</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#真正的pjax"><span class="nav-number">3.2.</span> <span class="nav-text">真正的pjax</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#第一步"><span class="nav-number">3.2.1.</span> <span class="nav-text">第一步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第二步"><span class="nav-number">3.2.2.</span> <span class="nav-text">第二步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三步"><span class="nav-number">3.2.3.</span> <span class="nav-text">第三步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第四步"><span class="nav-number">3.2.4.</span> <span class="nav-text">第四步</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#专门基于hexo-next主题的pjax（将丢失的js效果重现）"><span class="nav-number">4.</span> <span class="nav-text">专门基于hexo next主题的pjax（将丢失的js效果重现）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#将下面讲到的提取出来"><span class="nav-number">4.1.</span> <span class="nav-text">将下面讲到的提取出来</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#点击右边的sidebar，sidebar不出现"><span class="nav-number">4.2.</span> <span class="nav-text">点击右边的sidebar，sidebar不出现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sidebar自动隐藏，自动显示，点击出现，点击隐藏，回到首页，回到中间等操作"><span class="nav-number">4.2.1.</span> <span class="nav-text">sidebar自动隐藏，自动显示，点击出现，点击隐藏，回到首页，回到中间等操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加bootstrp出现闪屏的现象"><span class="nav-number">4.2.2.</span> <span class="nav-text">添加bootstrp出现闪屏的现象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#右边的sidebar鼠标滚动目录滑动事件没了"><span class="nav-number">4.2.3.</span> <span class="nav-text">右边的sidebar鼠标滚动目录滑动事件没了</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#局部刷新文章不显示了，文章那里是空白的。"><span class="nav-number">4.2.4.</span> <span class="nav-text">局部刷新文章不显示了，文章那里是空白的。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#评论没了"><span class="nav-number">4.2.5.</span> <span class="nav-text">评论没了</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#局部会闪一下"><span class="nav-number">4.2.6.</span> <span class="nav-text">局部会闪一下</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#阅读数没了"><span class="nav-number">4.2.7.</span> <span class="nav-text">阅读数没了</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#百度统计-解决了footer自动推送"><span class="nav-number">4.2.8.</span> <span class="nav-text">百度统计(解决了footer自动推送)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不蒜子阅读次数失效-解决"><span class="nav-number">4.2.9.</span> <span class="nav-text">不蒜子阅读次数失效(解决)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分类动态（css样式，js不行）"><span class="nav-number">4.2.10.</span> <span class="nav-text">分类动态（css样式，js不行）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分享失败"><span class="nav-number">4.2.11.</span> <span class="nav-text">分享失败</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#评分系统（已经舍弃，感觉无用）"><span class="nav-number">4.2.12.</span> <span class="nav-text">评分系统（已经舍弃，感觉无用）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#懒加载函数"><span class="nav-number">4.2.13.</span> <span class="nav-text">懒加载函数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#忘了最后最重要的一点一点，点击浏览器的返回前进按钮，特效还是失败了"><span class="nav-number">5.</span> <span class="nav-text">忘了最后最重要的一点一点，点击浏览器的返回前进按钮，特效还是失败了</span></a></li></ol></div></div></section></div></aside></div><script>function password(){}var div=$(".post-body"),toc=$(".post-toc-wrap");password()</script></main></div><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2019</span> <span class="with-love" id="heart"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Leesin.Dong</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i>总访客 <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 人 </span><span class="site-pv"><i class="fa fa-eye"></i>访问量 <span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("复制").on("click",function(t){var e=$(this).parent().find(".code").find(".line").map(function(t,e){return $(e).text()}).toArray().join("\n"),n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();var o=document.execCommand("copy");document.body.removeChild(n),o?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("复制")},300)}).append(e)})</script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css"><script src="/lib/algolia-instant-search/instantsearch.min.js"></script><script src="/js/src/algolia-search.js?v=5.1.4"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script>AV.initialize("6og9b7lpddMqazBCDe8z4HqL-gzGzoHsz","faKN7dalSdXLmYYJTRq98B1f")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)return void o.find(t).text(0);for(var i=0;i<e.length;i++){var r=e[i],s=r.get("url"),l=r.get("time"),c=document.getElementById(s);$(c).find(t).text(l)}for(var i=0;i<n.length;i++){var s=n[i],c=document.getElementById(s),u=$(c).find(t);""==u.text()&&u.text(0)}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e,s=new AV.ACL;s.setPublicReadAccess(!0),s.setPublicWriteAccess(!0),r.setACL(s),r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></body></html><script src="/js/src/pjax/lazyload_min.js"></script><script src="/js/src/pjax/comments/comments.gitalk.js"></script><script src="/js/src/pjax/require.js" defer async data-main="/js/src/pjax/main.js"></script><!-- rebuild by neat -->